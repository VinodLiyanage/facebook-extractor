function br2nl(a){return a.replace(/<br\s*\/?>/gm,"\r\n")}function executeCopy(a){var b=chrome.extension.getBackgroundPage(),c=document.createElement("textarea");document.body.appendChild(c),b.autosavepay||(a+="\n\nUpgrade the extension to autosave and automate your emails ID capture."),c.value=a,c.focus(),c.select(),document.execCommand("Copy"),c.remove();var d=b.version,e=b.localtoken;b.useremails.length>0&&(e=JSON.stringify(b.useremails)),_gaq.push(["_trackEvent","copy",e,d]);var f={url:$("#showCurrentUrl").html()};chrome.runtime.sendMessage(chrome.runtime.id,{options:"stats",event:"copy",data:f},function(a){})}function getDomainName(a){return a.indexOf("//")>=0&&(a=a.substr(a.indexOf("//")+2)),a.indexOf("/")>=0&&(a=a.substr(0,a.indexOf("/"))),a.substring(a.lastIndexOf(".",a.lastIndexOf(".")-1)+1)}var bg=chrome.extension.getBackgroundPage();bg.extensionenabled?($("#extensiononoff").attr("src","images/iconenabled.svg"),$("#wrapper").show(),$("body").css("height","315px"),$("#emailextractordisabled").hide(),$("#popuptitle").html("Email Extractor is enabled"),$("#showEmails").html("Refresh the page to capture email IDs")):($("#extensiononoff").attr("src","images/icondisabled.svg"),$("#wrapper").hide(),$("body").css("height","16px"),$("#emailextractordisabled").show(),$("#popuptitle").html("Email Extractor is disabled"));var autovisitrefreshtimer;bg.needtorate&&!bg.autosavepay&&$(".ratestars").show(),$(".ratestar").on("mouseover",function(a){a.preventDefault(),a.stopPropagation();var b=document.querySelectorAll(".ratestar"),c=0;for(i=0;i<b.length;i++)b[i]===this&&(c=i);for(i=0;i<b.length;i++)b[i].className="ratestar",i<=c&&(b[i].className+=" on")}),$(".ratestar").on("click",function(a){a.preventDefault(),a.stopPropagation();var b=document.querySelectorAll(".ratestar"),c=0;for(i=0;i<b.length;i++)b[i]===this&&(c=i);c>=3&&window.open("https://chrome.google.com/webstore/detail/jdianbbpnakhcmfkcckaboohfgnngfcc/reviews","_blank");var d=document.querySelectorAll(".ratestars");d.length>0&&d[0].remove(),c+=1,chrome.runtime.sendMessage(chrome.runtime.id,{options:"rated"},function(a){});var e=chrome.extension.getBackgroundPage(),f=e.localtoken;_gaq.push(["_trackEvent","rated",f,c.toString()])}),$(".ratestars").on("mouseover",function(a){a.preventDefault(),a.stopPropagation();var b=document.querySelectorAll(".ratestar");for(i=0;i<b.length;i++)b[i].className="ratestar"});var isdemo;isdemo||(isdemo=!1),chrome.runtime.sendMessage(chrome.runtime.id,{options:"counter"},function(a){}),chrome.storage.local.get(function(a){var b=a._saveMailList,c=a._emailsFound,d=a._currentUrl;void 0!=b&&""!=b||(b="None Found"),void 0==c&&(c="0"),bg.extensionenabled&&($("#popuptitle").html("Total Email ID's Found : <strong>"+c+"</strong>"),$("#showEmails").html(b),$("#showCurrentUrl").html(d));var e=$("#exportBtn");""==b||"None Found"==b?(e.attr("href","#"),e.removeAttr("download"),$(".functionsmenu").hide()):(bg.autosavepay||(b+="<br><br>Upgrade the extension to autosave and automate your emails ID capture."),e.attr("href","data:text/plain;base64,"+btoa(br2nl(b))),e.attr("download"),$(".functionsmenu").show());var f=$("#exportBtnCSV");""==b||"None Found"==b?(f.attr("href","#"),f.removeAttr("download")):(bg.autosavepay||(b+="<br><br>Upgrade the extension to autosave and automate your emails ID capture."),f.attr("href","data:text/csv;base64,"+btoa(br2nl(b))),f.attr("download"))});var downloadevent=function(){var a=chrome.extension.getBackgroundPage(),b="https://www.email-extractor.io/extension/autosave/token/"+a.localtoken;return chrome.tabs.create({url:b},function(a){}),$("#localtoken").val(a.localtoken),$("#overlay").fadeIn(1e3),!1},downloadeventxls=function(){var a=chrome.extension.getBackgroundPage();return $("#localtokenxls").val(a.localtoken),$("#downloadformxls").submit(),$("#overlay").fadeIn(1e3),!1},enableautovisit=function(a){bg.autosavepay&&$("#chkautosave").prop("checked")?a?($("#autovisitlaunch").show(),$("#autovisitstop").hide(),$("#autovisitdisabled").hide()):($("#autovisitlaunch").hide(),$("#autovisitstop").hide(),$("#autovisitdisabled").show()):($("#autovisitlaunch").show(),$("#autovisitstop").hide(),$("#autovisitdisabled").hide()),a?($("#selectblock").hide(),$("#showEmailsSelect").hide(),$("#showEmails").show(),$("#selectblockallnone").hide()):($("#selectblock").show(),$("#selectblockallnone").hide())};$("#overlay img").on("click",function(){$(this).parent().fadeOut(1e3)}),$("#autovisit img").on("click",function(){$(this).parent().fadeOut(1e3),$("#showautovisit").show()}),$("#fetchlinks").on("click",function(){chrome.storage.local.get(function(a){var b=a._saveLinkList;$("#autovisitlinks").val(br2nl(b))})}),$("#clearlinks").on("click",function(){$("#autovisitlinks").val(""),$("#showautovisit").css("width","65px"),$("#showautovisit").html("<span>Automation</span>")}),$("#clipboardcopy").on("click",function(){executeCopy(br2nl($("#showEmails").html())),$("#clipboardcopy").text("Copied"),window.setTimeout(function(){$("#clipboardcopy").text("Copy"),$(".clipboardcopy").text("Copy all")},1e3)}),$("#selectmailsall").on("click",function(){for(i=0;i<$(".mailselectchk").length;i++)$(".mailselectchk")[i].checked=!0,$(".mainfunctionsmenu").show(),$("#clipboardcopy").text("Copy all")}),$("#selectmailsnone").on("click",function(){for(i=0;i<$(".mailselectchk").length;i++)$(".mailselectchk")[i].checked=!1,$(".mainfunctionsmenu").hide()}),$("#selectmails").on("click",function(){$("#selectblock").hide(),$("#selectblockallnone").show();var a=$("#showEmails").html().split("<br>"),b="<table style='width:265px;'><col width='238'>";for(i=0;i<a.length;i++)a[i].length>0&&(b+="<tr>",b+="<td style='width:238px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;max-width:238px;flex-grow:1;'><input checked class='mailselectchk' type='checkbox' name='email-"+i+"' value='"+a[i]+"'><span>"+a[i]+"</span></td>",b+="</tr>");b+="</table>",$("#showEmailsSelect").html(b),$("#showEmails").hide(),$("#showEmailsSelect").show(),$(".mailselectchk").on("change",function(){$(".mailselectchk").length==$(".mailselectchk:checked").length?$("#clipboardcopy").text("Copy all"):$("#clipboardcopy").text("Copy"),this.checked?$(".mainfunctionsmenu").show():($("#clipboardcopy").text("Copy"),0==$(".mailselectchk:checked").length&&$(".mainfunctionsmenu").hide());var a="";for(i=0;i<$(".mailselectchk:checked ~ span").length;i++)a+=$(".mailselectchk:checked ~ span")[i].textContent+"<br>";$("#showEmails").html(a),bg.autosavepay||(a+="<br><br>Upgrade the extension to autosave and automate your emails ID capture."),$("#exportBtn").attr("href","data:text/plain;base64,"+btoa(br2nl(a))),$("#exportBtnCSV").attr("href","data:text/csv;base64,"+btoa(br2nl(a)))})}),$("#autovisitbutton").on("click",function(a){a.preventDefault();var b=chrome.extension.getBackgroundPage();if(!b.autosavepay&&!isdemo){var c="https://www.email-extractor.io/extension/autosave/token/"+b.localtoken;window.setTimeout(function(){chrome.tabs.create({url:c},function(a){})},3e3)}var d=$("#autovisitlinks").val().split("\n");chrome.windows.create({width:800,height:600,type:"popup",focused:!1},function(a){chrome.runtime.sendMessage(chrome.runtime.id,{options:"autovisitnavigate",urls:d,autovisitwindow:a.id,isdemo:isdemo},function(a){autovisitrefresh()}),isdemo=!1}),d.length>=1?($("#autovisitlinks").attr("disabled","disabled"),$("#autovisitdisabled").hide(),$("#autovisitlaunch").hide(),$("#autovisitstop").show()):($("#autovisitlinks").removeAttr("disabled"),$("#autovisitlaunch").show(),$("#autovisitdisabled").hide(),$("#autovisitstop").hide());var e=b.version,f=b.localtoken;b.useremails.length>0&&(f=JSON.stringify(b.useremails)),isdemo?_gaq.push(["_trackEvent","autovisitlaunch-demo",f,e]):_gaq.push(["_trackEvent","autovisitlaunch",f,e])}),$("#autovisitbuttonstop").on("click",function(){chrome.windows.remove(bg.autovisitwindow,function(){}),$("#autovisitlinks").removeAttr("disabled"),$("#autovisitlaunch").show(),$("#autovisitdisabled").hide(),$("#autovisitstop").hide(),window.clearTimeout(autovisitrefreshtimer)}),$("#autovisitbuttondisabled").on("click",function(){var a=chrome.extension.getBackgroundPage();if(!a.autosavepay){var b="https://www.email-extractor.io/extension/autosave/token/"+a.localtoken;chrome.tabs.create({url:b},function(a){})}return!1});var autovisitrefresh=function(){var a=bg.autovisitlinks;$("#autovisitlinks").val(a.join("\n"));var b="<span>Automation";a.length>0?(b+=" ("+a.length+")",$("#showautovisit").css("width","85px")):$("#showautovisit").css("width","65px"),b+="</span>",$("#showautovisit").html(b),bg.autovisitwindow!=-1?($("#autovisitlinks").attr("disabled","disabled"),$("#autovisitdisabled").hide(),$("#autovisitlaunch").hide(),$("#autovisitstop").show(),autovisitrefreshtimer=window.setTimeout(autovisitrefresh,1e3)):($("#autovisitlinks").removeAttr("disabled"),$("#autovisitlaunch").show(),$("#autovisitstop").hide(),$("#autovisitdisabled").hide(),window.clearTimeout(autovisitrefreshtimer))};$("#help").on("click",function(){$("#overlay").fadeIn(1e3)}),$("#exportBtn").on("click",function(){var a=document.getElementById("versionid").innerHTML,b=bg.localtoken;bg.useremails.length>0&&(b=JSON.stringify(bg.useremails)),_gaq.push(["_trackEvent","emailsExported",b,a])}),$("#cleanvalidatebutton").on("click",function(){var a=document.getElementById("versionid").innerHTML,b=bg.localtoken;bg.useremails.length>0&&(b=JSON.stringify(bg.useremails)),_gaq.push(["_trackEvent","cleanValidate",b,a])});var _gaq=_gaq||[];_gaq.push(["_setAccount","UA-40620403-5"]),_gaq.push(["_trackPageview"]),function(){var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src=chrome.extension.getURL("scripts/ga.js");var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b);var c=chrome.extension.getBackgroundPage();null==c&&chrome.runtime.reload(),document.getElementById("versionid").innerHTML=c.version;var d=document.getElementById("versionid").innerHTML,e=c.localtoken;$("#subscriptionlink").attr("href","https://www.email-extractor.io/extension/autosave/token/"+c.localtoken),$("#cleanvalidatebutton").attr("href","https://www.email-extractor.io/extension/autosave/token/"+c.localtoken),$("#buyautosave").attr("href","https://www.email-extractor.io/extension/autosave/token/"+c.localtoken),$("#currenttoken").html(c.localtoken),c.useremails.length>0&&(e=JSON.stringify(c.useremails)),_gaq.push(["_trackEvent","extensionOpened",e,d]),document.getElementById("download-csv")&&document.getElementById("download-csv").addEventListener("click",downloadevent),document.getElementById("download-xls")&&document.getElementById("download-xls").addEventListener("click",downloadeventxls)}(),$("#overlay img").on("click",function(){$(this).parent().fadeOut(1e3)}),$("#subscriptiondata img").on("click",function(){$(this).parent().fadeOut(1e3)}),$("#extensiononoff").on("click",function(){bg.extensionenabled?(chrome.runtime.sendMessage(chrome.runtime.id,{options:"extensionenable",enable:!1},function(a){}),$(this).attr("src","images/icondisabled.svg"),$("#wrapper").hide(),$("body").css("height","16px"),$("#emailextractordisabled").show(),$("#popuptitle").html("Email Extractor is disabled")):(chrome.runtime.sendMessage(chrome.runtime.id,{options:"extensionenable",enable:!0},function(a){}),$(this).attr("src","images/iconenabled.svg"),$("#wrapper").show(),$("body").css("height","315px"),$("#emailextractordisabled").hide(),$("#popuptitle").html("Email Extractor is enabled"),$("#showEmails").html("Refresh the page to capture email IDs"))}),$("#help").on("click",function(){$("#overlay").fadeIn(1e3)}),$("#showautovisit").on("click",function(){$("#subscriptiondata").hide(),bg.autosavepay&&!$("#chkautosave").prop("checked")&&($("#chkautosave").prop("checked",!0),$("#exportautosave").show(),$("#viewsubscription").show(),enableautovisit(!0),$("#viewtokenchange").show(),$("#selectblock").hide(),chrome.runtime.sendMessage(chrome.runtime.id,{options:"setautosave",enabled:!0,pay:!0},function(a){})),autovisitrefresh(),$("#showautovisit").hide(),$("#autovisit").fadeIn(1e3);var a=bg.version,b=bg.localtoken;bg.useremails.length>0&&(b=JSON.stringify(bg.useremails)),_gaq.push(["_trackEvent","autovisitshow",b,a])}),$("#showEmails").bind("copy",function(){var a=bg.version,b=bg.localtoken;bg.useremails.length>0&&(b=JSON.stringify(bg.useremails)),_gaq.push(["_trackEvent","copy-keys",b,a]);var c={url:$("#showCurrentUrl").html()};chrome.runtime.sendMessage(chrome.runtime.id,{options:"stats",event:"copy-keys",data:c},function(a){}),bg.autosavepay||(event.preventDefault(),executeCopy(window.getSelection()))}),$("#showsubscriptiondata").on("click",function(){var a=bg.version;"https://www.email-extractor.io/extension/autosave/token/"+bg.localtoken;$("#versionnumber").html("Version: "+a),$("#subscriptiondata").fadeIn(1e3)}),$("#changetoken").on("click",function(){var a=$("#newtoken").val();chrome.runtime.sendMessage(chrome.runtime.id,{options:"changetoken",token:a},function(a){})}),bg.autosavepay?($(".opennetwork").hide(),$("#viewtokenchange").hide(),$("#chkautosave").on("change",function(){chrome.runtime.sendMessage(chrome.runtime.id,{options:"setautosave",enabled:this.checked,pay:!0},function(a){}),this.checked?($("#exportautosave").show(),$("#viewsubscription").show(),$("#viewtokenchange").hide(),enableautovisit(!0)):enableautovisit(!1)}),bg.autosaveenabled&&($("#chkautosave").prop("checked",!0),enableautovisit(!0)),$("#exportautosave").show(),$("#viewsubscription").show(),$("#viewtokenchange").hide()):($("#showautovisit").addClass("notpay"),$("#buyautosave").show(),$("#fetchlinks").hide(),$("#trydemo").show(),$("#chkautosave").on("change",function(){this.checked?chrome.runtime.sendMessage(chrome.runtime.id,{options:"chkautosave",information:1,useremail:""},function(a){"undefined"!=typeof a?window.setTimeout(function(){bg.autosavepay?($("#exportautosave").show(),$("#viewsubscription").show(),$("#viewtokenchange").hide(),enableautovisit(!0),$("#showautovisit").removeClass("notpay"),$("#buyautosave").hide(),$("#fetchlinks").show(),$("#trydemo").hide()):(this.checked=!1,$("#exportautosave").hide(),$("#viewsubscription").hide(),$("#viewtokenchange").show(),enableautovisit(!1))},2e3):(console.log("Email Extractor Extension error: "+JSON.stringify(chrome.runtime.lastError)),window.setTimeout(function(){bg.autosavepay?($("#exportautosave").show(),$("#viewsubscription").show(),$("#viewtokenchange").hide(),enableautovisit(!0),$("#showautovisit").removeClass("notpay"),$("#buyautosave").hide(),$("#fetchlinks").show(),$("#trydemo").hide()):(this.checked=!1,$("#exportautosave").hide(),$("#viewsubscription").hide(),$("#viewtokenchange").show(),enableautovisit(!1))},4e3))}):($("#exportautosave").hide(),enableautovisit(!1))}),$("#trydemo").on("click",function(){$("#autovisitlinks").val("http://www.cmtbc.ca/rmts/nicole-berezowsky\nhttp://www.cmtbc.ca/rmts/barry-bereziak\nhttp://www.cmtbc.ca/rmts/brandon-benson\nhttp://www.cmtbc.ca/rmts/mark-bentz\nhttp://www.cmtbc.ca/rmts/chloe-beretta\nhttp://www.cmtbc.ca/rmts/lynne-berge\nhttp://www.cmtbc.ca/rmts/nicholas-berry\nhttp://www.cmtbc.ca/rmts/jennifer-berry\nhttp://www.cmtbc.ca/rmts/shannon-berrow"),isdemo=!0,window.setTimeout(function(){$("#autovisitbutton").click()},500)})),$("#chkslow").on("change",function(){chrome.runtime.sendMessage(chrome.runtime.id,{options:"setslow",enabled:this.checked},function(a){})}),bg.slowenabled&&$("#chkslow").prop("checked",!0),autovisitrefresh();