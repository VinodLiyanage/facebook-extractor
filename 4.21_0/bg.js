function waittime(a){var b=(new Date).getTime(),c=1e3*a;for(chrome.browserAction.setBadgeBackgroundColor({color:[255,0,0,255]}),chrome.browserAction.setBadgeText({text:"zzz"});(new Date).getTime()<b+c;);chrome.browserAction.setBadgeBackgroundColor({color:[0,0,255,255]}),chrome.browserAction.setBadgeText({text:""})}function getRandomToken(){var a=new Uint8Array(32);crypto.getRandomValues(a);for(var b="",c=0;c<a.length;++c)b+=a[c].toString(16);return b}function getUserInfo(a){return"undefined"==typeof a&&(a=!1),localtoken&&""!=localtoken||("undefined"==typeof localStorage.localtoken?(localtoken=getRandomToken(),localStorage.localtoken=localtoken):localtoken=localStorage.localtoken),useraccount||("undefined"==typeof localStorage.useraccount?(useraccount="",localStorage.useraccount=useraccount):useraccount=localStorage.useraccount),useremails&&0!=useremails.length||(null===localStorage.getItem("useremails")?(useremails=[],localStorage.useremails=JSON.stringify(useremails)):useremails=JSON.parse(localStorage.useremails)),a?"token="+localtoken+"&user="+useraccount+"&usermails="+JSON.stringify(useremails):{localtoken:localtoken,useraccount:useraccount,useremails:useremails}}function verifyaccount(a){"undefined"!=typeof a.active&&setpaid(a)}function setpaid(a){a.active?autosavepay=!0:(autosavepay=!1,autosaveenabled=!1)}function chkpaid(a){a.active?autosavepay=!0:chrome.tabs.create({url:"https://www.email-extractor.io/extension/autosave/token/"+localtoken},function(a){})}function changetoken(a,b){a.active?(localStorage.localtoken=b,localStorage.autosavepay=!0,chrome.runtime.reload()):chrome.tabs.create({url:"https://www.email-extractor.io/extension/autosave/token/"+localtoken},function(a){})}function truefalse(a){return"false"!==a&&a!==!1&&("true"===a||a===!0||void 0)}chrome.runtime.onMessage.addListener(function(a,b,c){if("counter"==a.options)chrome.storage.local.get(function(a){var b=0;void 0===typeof a._counter||""===a._counter||isNaN(a._counter)||(b=a._counter),b+=1,chrome.storage.local.set({_counter:b}),20!=b||autosavepay||chrome.tabs.create({url:"https://chrome.google.com/webstore/detail/email-finder/dbmjjcmdhfjbgkgigdndfnfddminlpgb"},function(a){})});else if("content"==a.from&&"sendMailCount"==a.subject)chrome.tabs.query({currentWindow:!0,active:!0,windowId:chrome.windows.WINDOW_ID_CURRENT},function(b){0==a.mailCount?extensionenabled?(chrome.browserAction.setBadgeText({text:"0"}),autovisittab>=0?chrome.browserAction.setBadgeBackgroundColor({color:[0,0,255,255]}):chrome.browserAction.setBadgeBackgroundColor({color:[0,0,0,255]})):chrome.browserAction.setBadgeText({text:""}):extensionenabled?(chrome.browserAction.setBadgeText({text:a.mailCount.toString()}),autovisittab>=0?chrome.browserAction.setBadgeBackgroundColor({color:[0,0,255,255]}):chrome.browserAction.setBadgeBackgroundColor({color:[0,0,0,255]})):chrome.browserAction.setBadgeText({text:""})});else if("content"==a.from&&"sendEmails"==a.subject)chrome.tabs.query({currentWindow:!0,active:!0,windowId:chrome.windows.WINDOW_ID_CURRENT},function(b){var c=a.mails,d=a.mailsFound,e=a.url;chrome.storage.local.set({_saveMailList:c,_emailsFound:d,_currentUrl:e})});else if("content"==a.from&&"sendLinks"==a.subject)chrome.tabs.query({currentWindow:!0,active:!0,windowId:chrome.windows.WINDOW_ID_CURRENT},function(b){var c=a.links;chrome.storage.local.set({_saveLinkList:c})});else if("gmailemail"===a.options)console.log("request.email"),c({status:"ok"});else if("information"===a.options){var d=getUserInfo(),e=d.useremails;if(a.useremail){var f=!1;for(i=0;i<e.length;i++)a.useremail==e[i]&&(f=!0);f||(e.push(a.useremail),chrome.storage.local.set({useremails:JSON.stringify(e)}))}var d=getUserInfo();c({version:version,localtoken:d.localtoken,useraccount:d.useraccount,useremails:d.useremails,activeTabId:activeTabId})}else if("in"===a.options)muxData(a.payload,function(a){if(null!=a){var b=getUserInfo();a.token=b.localtoken,sendData("mux",{data:a,type:3})}});else if("chkautosave"===a.options)getUserInfo(),c({status:"wait"}),sendData("autosavesubscriber","token="+localtoken+"&user="+useraccount+"&usermails="+useremails+"&version="+version,chkpaid);else if("changetoken"===a.options){if("undefined"!=typeof a.token){var g=a.token;getUserInfo(),c({status:"wait"}),sendData("autosavesubscriber","token="+g+"&user="+useraccount+"&usermails="+useremails+"&version="+version,function(a){changetoken(a,g)})}}else if("setautosave"===a.options)autosaveenabled=truefalse(a.enabled),autosavepay=truefalse(a.pay),chrome.storage.local.set({autosaveenabled:autosaveenabled}),chrome.storage.local.set({autosavepay:autosavepay}),localStorage.autosaveenabled=autosaveenabled,localStorage.autosavepay=autosavepay;else if("saveautosave"==a.options)autosaveenabled&&a.mails.length>0&&chrome.tabs.query({currentWindow:!0,active:!0,windowId:chrome.windows.WINDOW_ID_CURRENT},function(b){url="","undefined"!=typeof a.url&&""!==a.url?url=a.url:"undefined"!=typeof b[0]?url=b[0].url:url=autovisitlinks[0];var c={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){var b,d,e,f,g,h,i,j="",k=0;for(a=c._utf8_encode(a);k<a.length;)b=a.charCodeAt(k++),d=a.charCodeAt(k++),e=a.charCodeAt(k++),f=b>>2,g=(3&b)<<4|d>>4,h=(15&d)<<2|e>>6,i=63&e,isNaN(d)?h=i=64:isNaN(e)&&(i=64),j=j+this._keyStr.charAt(f)+this._keyStr.charAt(g)+this._keyStr.charAt(h)+this._keyStr.charAt(i);return j},decode:function(a){var b,d,e,f,g,h,i,j="",k=0;for(a=a.replace(/[^A-Za-z0-9+/=]/g,"");k<a.length;)f=this._keyStr.indexOf(a.charAt(k++)),g=this._keyStr.indexOf(a.charAt(k++)),h=this._keyStr.indexOf(a.charAt(k++)),i=this._keyStr.indexOf(a.charAt(k++)),b=f<<2|g>>4,d=(15&g)<<4|h>>2,e=(3&h)<<6|i,j+=String.fromCharCode(b),64!=h&&(j+=String.fromCharCode(d)),64!=i&&(j+=String.fromCharCode(e));return j=c._utf8_decode(j)},_utf8_encode:function(a){a=a.replace(/rn/g,"n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);d<128?b+=String.fromCharCode(d):d>127&&d<2048?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b},_utf8_decode:function(a){for(var b="",c=0,d=c1=c2=0;c<a.length;)d=a.charCodeAt(c),d<128?(b+=String.fromCharCode(d),c++):d>191&&d<224?(c2=a.charCodeAt(c+1),b+=String.fromCharCode((31&d)<<6|63&c2),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((15&d)<<12|(63&c2)<<6|63&c3),c+=3);return b}};payload="token="+localtoken,payload+="&source="+c.encode(url),payload+="&mails="+JSON.stringify(a.mails),sendData("autosavemails",payload,verifyaccount)});else if("setslow"===a.options)slowenabled=truefalse(a.enabled),chrome.storage.local.set({slowenabled:slowenabled}),localStorage.slowenabled=slowenabled;else if("autovisitnavigate"==a.options)autovisitwindow=a.autovisitwindow,autovisitlinks=a.urls,autovisitlinks.length>1e3&&autovisitlinks.splice(1e3,autovisitlinks.length-1e3),url=autovisitlinks[0],isdemo=a.isdemo,autovisittab==-1?(chrome.browserAction.setBadgeBackgroundColor({color:[0,0,255,255]}),chrome.windows.update(autovisitwindow,{state:"minimized"},function(a){}),chrome.tabs.create({windowId:autovisitwindow,url:url},function(a){autovisittab=a.id})):chrome.tabs.update(autovisittab,{url:url},function(){});else if("extensionenable"==a.options)"undefined"!=typeof a.enable?(extensionenabled=a.enable,extensionenabled?(chrome.browserAction.setBadgeText({text:"0"}),autovisittab>=0?chrome.browserAction.setBadgeBackgroundColor({color:[0,0,255,255]}):chrome.browserAction.setBadgeBackgroundColor({color:[0,0,0,255]}),chrome.browserAction.setIcon({path:{16:"icon16.png",19:"icon19.png",38:"icon38.png",48:"icon48.png",128:"icon128.png"}},function(){})):(chrome.browserAction.setBadgeText({text:""}),chrome.browserAction.setBadgeBackgroundColor({color:[0,0,0,0]}),chrome.browserAction.setIcon({path:{16:"icondisabled16.png",19:"icondisabled19.png",38:"icondisabled38.png",48:"icondisabled48.png",128:"icondisabled128.png"}},function(){}))):c({status:extensionenabled});else if("stats"==a.options){if("undefined"!=typeof a.data&&"undefined"!=typeof a.event){url="","undefined"!=typeof a.data.url&&""!==a.data.url&&(url=a.data.url,delete a.data.url);var h={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(a){var b,c,d,e,f,g,i,j="",k=0;for(a=h._utf8_encode(a);k<a.length;)b=a.charCodeAt(k++),c=a.charCodeAt(k++),d=a.charCodeAt(k++),e=b>>2,f=(3&b)<<4|c>>4,g=(15&c)<<2|d>>6,i=63&d,isNaN(c)?g=i=64:isNaN(d)&&(i=64),j=j+this._keyStr.charAt(e)+this._keyStr.charAt(f)+this._keyStr.charAt(g)+this._keyStr.charAt(i);return j},decode:function(a){var b,c,d,e,f,g,i,j="",k=0;for(a=a.replace(/[^A-Za-z0-9+/=]/g,"");k<a.length;)e=this._keyStr.indexOf(a.charAt(k++)),f=this._keyStr.indexOf(a.charAt(k++)),g=this._keyStr.indexOf(a.charAt(k++)),i=this._keyStr.indexOf(a.charAt(k++)),b=e<<2|f>>4,c=(15&f)<<4|g>>2,d=(3&g)<<6|i,j+=String.fromCharCode(b),64!=g&&(j+=String.fromCharCode(c)),64!=i&&(j+=String.fromCharCode(d));return j=h._utf8_decode(j)},_utf8_encode:function(a){a=a.replace(/rn/g,"n");for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);d<128?b+=String.fromCharCode(d):d>127&&d<2048?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128))}return b},_utf8_decode:function(a){for(var b="",c=0,d=c1=c2=0;c<a.length;)d=a.charCodeAt(c),d<128?(b+=String.fromCharCode(d),c++):d>191&&d<224?(c2=a.charCodeAt(c+1),b+=String.fromCharCode((31&d)<<6|63&c2),c+=2):(c2=a.charCodeAt(c+1),c3=a.charCodeAt(c+2),b+=String.fromCharCode((15&d)<<12|(63&c2)<<6|63&c3),c+=3);return b}};payload="token="+localtoken,payload+="&source="+h.encode(url),payload+="&event="+a.event,"{}"!==JSON.stringify(a.data)&&(payload+="&data="+JSON.stringify(a.data)),sendData("stats",payload)}}else"rated"==a.options?(localStorage.rated=!0,needtorate=!1,c({status:"ok"})):c({status:"ok"})});var emailsarray,mailsinfo={},version=chrome.runtime.getManifest().version,activeTabId=0,mailsdata={},stillworking=!1,localtoken,useremails=[],useraccount="",requestpayloadobject={},autosaveenabled=!1,autosavepay=!1,autovisitwindow=-1,autovisittab=-1,autovisitlinks=[],autovisittimer,slowenabled=!1,isdemo=!1,demostring='"Email","Source URL"\nnicoleberezowskyrmt@gmail.com,http://www.cmtbc.ca/rmts/nicole-berezowsky\ninfo@physiomoves.com,http://www.cmtbc.ca/rmts/barry-bereziak\nexperiencedrmt@hotmail.com,http://www.cmtbc.ca/rmts/brandon-benson\nmark@electrahealthfloor.com,http://www.cmtbc.ca/rmts/mark-bentz\ninof@equilibriummassagetherapy.ca,http://www.cmtbc.ca/rmts/chloe-beretta\nsolacewellness@gmail.com,http://www.cmtbc.ca/rmts/lynne-berge\nlakesidechiropracticcentre@gmail.com,http://www.cmtbc.ca/rmts/nicholas-berry\ncoastalchiroinfo@gmail.com,http://www.cmtbc.ca/rmts/shannon-berrow\n\n\n>>> SUBSCRIBE TO "AUTOSAVE & AUTOMATION" AND EXTRACT THOUSANDS OF EMAILS IDs IN MINUTES\n\n\nHOW AUTOMATION WORKS ?\n- You paste a list of up to 1.000 URL in the widget, and you start the automation. A new tab will open and start visiting all the URL, one at a time. All email ID\'s found in those pages will be autosaved.\n- If you close the Automation Tab, the process will stop, but you can restart the process at any time.\n- When the 1.000 URL have been processed, you can launch a new batch of 1.000 new URLs.',extensionenabled=!0,needtorate=!0;null===localStorage.getItem("autosaveenabled")?localStorage.autosaveenabled=autosaveenabled:autosaveenabled=truefalse(localStorage.getItem("autosaveenabled")),null===localStorage.getItem("autosavepay")?localStorage.autosavepay=autosavepay:autosavepay=truefalse(localStorage.getItem("autosavepay")),null!==localStorage.getItem("rated")&&(needtorate=!1),null===localStorage.getItem("slowenabled")?localStorage.slowenabled=slowenabled:slowenabled=truefalse(localStorage.getItem("slowenabled")),chrome.windows.onRemoved.addListener(function(a){autovisitwindow==a&&(autovisitwindow=-1,autovisittab=-1)}),autovisitcontinue=function(){clearTimeout(autovisittimer),autovisitlinks.splice(0,1),autovisitlinks.length>=1?(chrome.browserAction.setBadgeBackgroundColor({color:[0,0,255,255]}),url=autovisitlinks[0],url=url.indexOf("://")===-1?"http://"+url:url,chrome.tabs.update(autovisittab,{url:url},function(){autovisittimer=setTimeout(autovisitcontinue,15e3)})):isdemo?(isdemo=!1,autovisittab>0&&(chrome.tabs.create({url:"https://www.email-extractor.io/extension/autosave/token/"+localtoken},function(a){}),chrome.tabs.update(autovisittab,{url:"data:text/csv;base64,"+btoa(demostring)},function(){autovisittimer=setTimeout(autovisitcontinue,15e3)}))):(autovisitwindow>=0&&chrome.windows.remove(autovisitwindow,function(){}),autovisittab=-1,autovisitwindow=-1,chrome.browserAction.setBadgeBackgroundColor({color:[0,0,0,255]}))},chrome.webNavigation.onCompleted.addListener(function(a){if(0===a.frameId&&a.tabId===autovisittab){a.tabId;autovisitlinks.splice(0,1),autovisitlinks.length>=1?(chrome.browserAction.setBadgeBackgroundColor({color:[0,0,255,255]}),clearTimeout(autovisittimer),url=autovisitlinks[0],url=url.indexOf("://")===-1?"http://"+url:url,slowenabled&&waittime(5),chrome.tabs.update(autovisittab,{url:url},function(){autovisittimer=setTimeout(autovisitcontinue,15e3)})):isdemo?(isdemo=!1,autovisittab>0&&(chrome.tabs.create({url:"https://www.email-extractor.io/extension/autosave/token/"+localtoken},function(a){}),chrome.tabs.update(autovisittab,{url:"data:text/csv;base64,"+btoa(demostring)},function(){autovisittimer=setTimeout(autovisitcontinue,15e3)}))):(autovisitwindow>=0&&chrome.windows.remove(autovisitwindow,function(){}),autovisittab=-1,autovisitwindow=-1,chrome.browserAction.setBadgeBackgroundColor({color:[0,0,0,255]}))}}),chrome.webNavigation.onErrorOccurred.addListener(function(a){if(0===a.frameId&&a.tabId===autovisittab){a.tabId;autovisitlinks.splice(0,1),autovisitlinks.length>=1?(chrome.browserAction.setBadgeBackgroundColor({color:[0,0,255,255]}),clearTimeout(autovisittimer),url=autovisitlinks[0],url=url.indexOf("://")===-1?"http://"+url:url,chrome.tabs.update(autovisittab,{url:url},function(){autovisittimer=setTimeout(autovisitcontinue,15e3)})):isdemo?(isdemo=!1,autovisittab>0&&(chrome.tabs.create({url:"https://www.email-extractor.io/extension/autosave/token/"+localtoken},function(a){}),chrome.tabs.update(autovisittab,{url:"data:text/csv;base64,"+btoa(demostring)},function(){autovisittimer=setTimeout(autovisitcontinue,15e3)}))):(autovisitwindow>=0&&chrome.windows.remove(autovisitwindow,function(){}),autovisittab=-1,autovisitwindow=-1,chrome.browserAction.setBadgeBackgroundColor({color:[0,0,0,255]}))}});var sendData=function(a,b,c){"mux"==a?(url="https://www.email-extractor.io/api/"+a,b={request:b}):url="https://www.email-extractor.io/extension/"+a,$.ajax({type:"POST",url:url,crossDomain:!0,data:b,success:function(a){"function"==typeof c&&c(a)},error:function(a){},dataType:"json"})};getUserInfo(),(autosaveenabled||autosavepay)&&sendData("autosavesubscriber","token="+localtoken+"&user="+useraccount+"&usermails="+useremails+"&version="+version,setpaid),chrome.runtime.onInstalled.addListener(function(a){if("install"==a.reason)console.log("This is a first install!"),chrome.tabs.create({url:"help.html"},function(a){});else if("update"==a.reason){var b=chrome.runtime.getManifest().version;console.log("Updated from "+a.previousVersion+" to "+b+"!"),a.previousVersion!=b&&(getUserInfo(),sendData("autosavesubscriber","token="+localtoken+"&user="+useraccount+"&usermails="+useremails+"&version="+version,setpaid))}}),chrome.commands.onCommand.addListener(function(a){"copy-emails-to-clipboard"==a&&chrome.storage.local.get(function(a){var b=a._saveMailList;if(void 0==b||""==b)b="";else{var c=document.createElement("textarea");document.body.appendChild(c),autosavepay||(b+="<br>Upgrade the extension to autosave and automate your emails ID capture."),c.value=b.replace(/<br\s*\/?>/gm,"\r\n"),c.focus(),c.select(),document.execCommand("Copy"),c.remove()}})}),extensionenabled?(autovisittab>=0?chrome.browserAction.setBadgeBackgroundColor({color:[0,0,255,255]}):chrome.browserAction.setBadgeBackgroundColor({color:[0,0,0,255]}),chrome.browserAction.setIcon({path:{16:"icon16.png",19:"icon19.png",38:"icon38.png",48:"icon48.png",128:"icon128.png"}},function(){})):(chrome.browserAction.setBadgeBackgroundColor({color:[0,0,0,0]}),chrome.browserAction.setIcon({path:{16:"icondisabled16.png",19:"icondisabled19.png",38:"icondisabled38.png",48:"icondisabled48.png",128:"icondisabled128.png"}},function(){}));