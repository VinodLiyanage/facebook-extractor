function initalizeOnce(a){var b;return function(){return a&&(b=a.apply(this,arguments)),a=null,b}}var Gmail_=function(a){var b;"undefined"!=typeof a?b=a:"undefined"!=typeof jQuery&&(b=jQuery);var c={get:{},observe:{},check:{},tools:{},tracker:{},dom:{},chat:{},compose:{},helper:{get:{}}};return c.version="0.5",c.tracker.globals="undefined"!=typeof GLOBALS?GLOBALS:null!=window.opener&&"undefined"!=typeof window.opener.GLOBALS?window.opener.GLOBALS:[],c.tracker.view_data="undefined"!=typeof VIEW_DATA?VIEW_DATA:null!=window.opener&&"undefined"!=typeof window.opener.VIEW_DATA?window.opener.VIEW_DATA:[],c.tracker.ik=c.tracker.globals[9]||"",c.tracker.hangouts=void 0,c.get.last_active=function(){var a=c.tracker.globals[17][15];return{time:a[1],ip:a[3],mac_address:a[9],time_relative:a[10]}},c.get.loggedin_accounts=function(){var a,b,d,e=[],f=c.tracker.globals[17];for(a in f)if(d=f[a],"mla"===d[0]){for(b in d[1])e.push({name:d[1][b][4],email:d[1][b][0],index:d[1][b][3]});return e}return e},c.get.user_email=function(){return c.tracker.globals[10]},c.get.manager_email=function(){return c.helper.get.is_delegated_inbox()?c.get.delegated_to_email():c.get.user_email()},c.get.delegated_to_email=function(){if(!c.helper.get.is_delegated_inbox())return null;var a,d,e="/u/",f=window.location.pathname,g=parseInt(f.substring(f.indexOf(e)+e.length),10),h=c.get.loggedin_accounts();if(h&&h.length>0)for(a in h)if(d=h[a],d.index===g)return d.email;return b(".gb_rb[href$='"+e+g+"'] .gb_yb").text().split(" ")[0]},c.get.localization=function(){var a=function(a){if(!a||"string"!=typeof a||a.length<2)return!1;var b=a.slice(0,2);return b.toLowerCase()===b},b=c.tracker.globals,d=b[17]&&b[17][8]&&b[17][8][8];return a(d)?d:(d=b[17]&&b[17][9]&&b[17][9][8],a(d)?d:null)},c.check.is_thread=function(){var a=b(".nH .if").children(":eq(1)").children().children(":eq(1)").children(),d=c.get.email_ids();return a.length>1||d.length>1},c.dom.inbox_content=function(){return b("div[role=main]:first")},c.check.is_preview_pane=function(){var a=c.dom.inbox_content(),d=a.find("[gh=tl]"),e=!1;return d.each(function(){b(this).hasClass("aia")&&(e=!0)}),e},c.check.is_multiple_inbox=function(){var a=c.dom.inboxes();return a.length>1},c.check.is_horizontal_split=function(){var a=c.dom.inbox_content(),b=a.find("[gh=tl]").find(".nn");return 0==b.length},c.check.is_vertical_split=function(){return 0==c.check.is_horizontal_split()},c.check.is_tabbed_inbox=function(){return 1==b(".aKh").length},c.check.is_right_side_chat=function(){var a=b(".ApVoH");return 0!==a.length&&":wf"==a[0].getAttribute("aria-labelledby")},c.check.should_compose_fullscreen=function(){var a=[];try{a=c.tracker.globals[17][4][1][32]}catch(b){a=["bx_scfs","false"]}return"true"==a[1]},c.check.is_google_apps_user=function(){var a=c.get.user_email();return a.indexOf("gmail.com",a.length-"gmail.com".length)==-1},c.get.storage_info=function(){var a=b(".md.mj").find("div")[0],c=b(a).find("span")[0].text,d=b(a).find("span")[1].text,e=100*parseFloat(c.replace(/[^0-9\.]/g,""))/parseFloat(d.replace(/[^0-9\.]/g,""));return{used:c,total:d,percent:Math.floor(e)}},c.dom.inboxes=function(){var a=c.dom.inbox_content();return a.find("[gh=tl]")},c.dom.email_subject=function(){for(var a=b(".hP"),c=0;c<a.length;c++)if(b(a[c]).is(":visible"))return b(a[c]);return b()},c.get.email_subject=function(){var a=c.dom.email_subject();return a.text()},c.dom.email_body=function(){return b(".nH.hx")},c.dom.toolbar=function(){for(var a=b("[gh='mtb']");1==b(a).children().length;)a=b(a).children().first();return a},c.check.is_inside_email=function(){if("email"!=c.get.current_page()&&!c.check.is_preview_pane())return!1;for(var a=b(".ii.gt .a3s.aXjCH"),d=[],e=0;e<a.length;e++){var f=a[e].getAttribute("class").split(" ")[2];"undefined"!=f&&void 0!=f&&b(a[e]).is(":visible")&&d.push(a[e])}return d.length>0},c.check.is_plain_text=function(){for(var a=GLOBALS[17][4][1],b=0;b<a.length;b++){var c=a[b];if("bx_cm"===c[0])return"0"===c[1]}return!1},c.dom.email_contents=function(){for(var a=b(".ii.gt div.a3s.aXjCH"),c=[],d=0;d<a.length;d++){var e=a[d].getAttribute("class").split(" ")[2],f=a[d].getAttribute("contenteditable");"undefined"!=e&&void 0!=e&&"true"!=f&&c.push(a[d])}return c},c.get.email_ids=function(){if(c.check.is_inside_email()){var a=c.get.email_data();return Object.keys(a.threads)}return[]},c.get.compose_ids=function(){for(var a=[],c=b(".AD [name=draft]"),d=0;d<c.length;d++)"undefined"!=c[d].value&&a.push(c[d].value);return a},c.get.email_id=function(){var a=null;if(c.check.is_inside_email())if(c.check.is_preview_pane()){for(var b=c.dom.email_contents(),d=[],e=0;e<b.length;e++){var f=b[e].children[0].getAttribute("class").split(" ")[2],g=b[e].getAttribute("contenteditable"),h=b[e].offsetWidth>0&&b[e].offsetHeight>0;"undefined"!=f&&void 0!=f&&h&&"true"!=g&&d.push(f)}a=d[0].substring(1,d[0].length)}else a=window.location.hash.split("/").pop().replace(/#/,"").split("?")[0];else a=c.tools.parse_url(window.location.href).th;return a},c.check.is_priority_inbox=function(){return b(".qh").length>0},c.check.is_rapportive_installed=function(){return 1==b("#rapportive-sidebar").length},c.check.is_streak_installed=function(){return b("[id^='bentoBox'],[id*=' bentoBox'],[class*=' bentoBox'],[class*='bentoBox']").length>0},c.check.is_anydo_installed=function(){return b("[id^='anydo'],[id*=' anydo'],[class*=' anydo'],[class*='anydo']").length>0},c.check.is_boomerang_installed=function(){return b("[id^='b4g_'],[id*=' b4g_'],[class*=' b4g_'],[class*='b4g_']").length>0},c.check.is_xobni_installed=function(){return b("#xobni_frame").length>0},c.check.is_signal_installed=function(){return b("[id^='Signal'],[id*=' Signal'],[class*=' signal'],[class*='signal']").length>0},c.check.are_shortcuts_enabled=function(){for(var a="bx_hs",b=void 0,d=!0,e=c.tracker.globals[17][4][1],f=0;f<e.length;f++){var g=e[f];if(g[0]===a){b=g[1];break}}if(void 0!==b){var h={0:!0,1:!1};d=h[b]}return d},c.dom.get_left_sidebar_links=function(){return b("div[role=navigation] [title]")},c.dom.search_bar=function(){return b("[gh=sb]")},c.get.search_query=function(){var a=c.dom.search_bar();return a.find("input")[0].value},c.get.unread_inbox_emails=function(){var a=b("div[role=navigation]").find("[title*='"+c.tools.i18n("inbox")+"']");return a.length>0&&a[0].text.indexOf("(")!=-1?parseInt(a[0].text.replace(/[^0-9]/g,"")):0},c.get.unread_draft_emails=function(){var a=b("div[role=navigation]").find("[title*='"+c.tools.i18n("drafts")+"']");return a.length>0&&a[0].text.indexOf("(")!=-1?parseInt(a[0].text.replace(/[^0-9]/g,"")):0},c.get.unread_spam_emails=function(){var a=b("div[role=navigation]").find("[title*='"+c.tools.i18n("spam")+"']");return a.length>0&&a[0].text.indexOf("(")!=-1?parseInt(a[0].text.replace(/[^0-9]/g,"")):0},c.get.unread_forum_emails=function(){var a=b("div[role=navigation]").find("[title*='"+c.tools.i18n("forums")+"']");return a.length>0&&a[0].text.indexOf("(")!=-1?parseInt(a[0].text.replace(/[^0-9]/g,"")):0},c.get.unread_update_emails=function(){var a=b("div[role=navigation]").find("[title*='"+c.tools.i18n("updates")+"']");return a.length>0&&a[0].text.indexOf("(")!=-1?parseInt(a[0].text.replace(/[^0-9]/g,"")):0},c.get.unread_promotion_emails=function(){var a=b("div[role=navigation]").find("[title*='"+c.tools.i18n("promotions")+"']");return a.length>0&&a[0].text.indexOf("(")!=-1?parseInt(a[0].text.replace(/[^0-9]/g,"")):0},c.get.unread_social_emails=function(){var a=b("div[role=navigation]").find("[title*='"+c.tools.i18n("social_updates")+"']");return a.length>0&&a[0].text.indexOf("(")!=-1?parseInt(a[0].text.replace(/[^0-9]/g,"")):0},c.get.beta=function(){var a={new_nav_bar:0==b("#gbz").length};return a},c.get.unread_emails=function(){return{inbox:c.get.unread_inbox_emails(),drafts:c.get.unread_draft_emails(),spam:c.get.unread_spam_emails(),forum:c.get.unread_forum_emails(),update:c.get.unread_update_emails(),promotions:c.get.unread_promotion_emails(),social:c.get.unread_social_emails()}},c.tools.error=function(a){if(!console)throw a;console.error(a)},c.tools.parse_url=function(a){for(var b,c=/[?&]([^=#]+)=([^&#]*)/g,d={};b=c.exec(a);)d[b[1]]=b[2];return d},c.tools.sleep=function(a){for(var b=(new Date).getTime();;)if((new Date).getTime()-b>a)break},c.tools.multitry=function(a,b,d,e,f,g){if(void 0!=f&&f>=b)return g;f=void 0==f?0:f;var h=d();return e(h)?h:(c.tools.sleep(a),void c.tools.multitry(a,b,d,e,f+1,h))},c.tools.deparam=function(a,b){var c=function(a,b){for(var c=[],d=0;d<a.length;d++)c.push(b(a[d]));return c},d=Array.isArray||function(a){return"[object Array]"==Object.prototype.toString.call(a)},e={},f={"true":!0,"false":!1,"null":null};return c(a.replace(/\+/g," ").split("&"),function(a,c){var g,h=a.split("="),i=decodeURIComponent(h[0]),j=e,k=0,l=i.split("]["),m=l.length-1;if(/\[/.test(l[0])&&/\]$/.test(l[m])?(l[m]=l[m].replace(/\]$/,""),l=l.shift().split("[").concat(l),m=l.length-1):m=0,2===h.length)if(g=decodeURIComponent(h[1]),b&&(g=g&&!isNaN(g)?+g:"undefined"===g?void 0:void 0!==f[g]?f[g]:g),m)for(;k<=m;k++)i=""===l[k]?j.length:l[k],j=j[i]=k<m?j[i]||(l[k+1]&&isNaN(l[k+1])?{}:[]):g;else d(e[i])?e[i].push(g):void 0!==e[i]?e[i]=[e[i],g]:e[i]=g;else i&&(e[i]=b?void 0:"")}),e},c.tools.parse_actions=function(a,b){if("fup"==a.url.act||"fuv"==a.url.act||a.body_is_object)return!(!a.body_is_object||!c.observe.bound("upload_attachment"))&&{upload_attachment:[a.body_params]};void 0!=a.url.search;var d={},e={tae:"add_to_tasks","rc_^i":"archive",tr:"delete",cs:"undo_send",dm:"delete_message_in_thread",dl:"delete_forever",dc_:"delete_label",dr:"discard_draft",el:"expand_categories",cffm:"filter_messages_like_these",arl:"label",mai:"mark_as_important",mani:"mark_as_not_important",us:"mark_as_not_spam",sp:"mark_as_spam",mt:"move_label",ib:"move_to_inbox",ig:"mute",rd:"read",sd:"save_draft",sm:"send_message",mo:"show_newly_arrived_message",st:"star",ug:"unmute",ur:"unread",xst:"unstar",new_mail:"new_email",poll:"poll",refresh:"refresh",rtr:"restore_message_in_thread",open_email:"open_email",toggle_threads:"toggle_threads"};"string"==typeof a.url.ik&&(c.tracker.ik=a.url.ik),"string"==typeof a.url.at&&(c.tracker.at=a.url.at),"string"==typeof a.url.rid&&a.url.rid.indexOf("mail")!=-1&&(c.tracker.rid=a.url.rid);var f=decodeURIComponent(a.url.act),g=a.body_params,h="string"==typeof g.t?[g.t]:g.t,i=null;switch(f){case"cs":case"ur":case"rd":case"tr":case"sp":case"us":case"ib":case"dl":case"st":case"xst":case"mai":case"mani":case"ig":case"ug":case"dr":case"mt":case"cffm":case"rc_^i":i=[h,a.url,a.body];break;case"arl":i=[h,a.url,a.body,a.url.acn];break;case"sd":i=[h,a.url,g];break;case"tae":case"sm":i=[a.url,a.body,g];break;case"el":i=[a.url,a.body,"1"==g.ex];break;case"dm":case"rtr":case"mo":i=[g.m,a.url,a.body]}return"string"==typeof a.url._reqid&&"tl"===a.url.view&&void 0!=a.url.auto&&(i=[a.url.th,a.url,a.body],c.observe.bound("new_email")&&(d.new_email=i)),"cv"!=a.url.view&&"ad"!=a.url.view||"string"!=typeof a.url.th||"string"!=typeof a.url.search||void 0!=a.url.rid||(i=[a.url.th,a.url,a.body],c.observe.bound("open_email")&&(d.open_email=i)),"cv"!=a.url.view&&"ad"!=a.url.view||"object"!=typeof a.url.th||"string"!=typeof a.url.search||void 0==a.url.rid||(i=[a.url.th,a.url,a.body],c.observe.bound("toggle_threads")&&(d.toggle_threads=i)),"cv"!=a.url.view&&"ad"!=a.url.view||"string"!=typeof a.url.th||"string"!=typeof a.url.search||void 0==a.url.rid||void 0!=a.url.msgs&&(i=[a.url.th,a.url,a.body],c.observe.bound("toggle_threads")&&(d.toggle_threads=i)),"string"==typeof a.url.SID&&"string"==typeof a.url.zx&&a.body.indexOf("req0_")!=-1&&(c.tracker.SID=a.url.SID,i=[a.url,a.body,g],c.observe.bound("poll")&&(d.poll=i)),"string"==typeof a.url.ik&&"string"==typeof a.url.search&&0==a.body.length&&"string"==typeof a.url._reqid&&(i=[a.url,a.body,g],c.observe.bound("refresh")&&(d.refresh=i)),i&&e[f]&&c.observe.bound(e[f])&&(d[e[f]]=i),"POST"!=a.method||"string"!=typeof a.url.SID&&"string"!=typeof a.url.ik&&"string"!=typeof a.url.act||(d.http_event=[a]),d},c.tools.parse_response=function(a){var b,c,d,e,f=[];try{for(a=a.replace(/\n/g," "),a=a.substring(a.indexOf("'")+1,a.length);a.replace(/\s/g,"").length>1;){c=a.substring(0,a.indexOf("[")).replace(/\s/g,""),c||(c=a.length),d=parseInt(c,10)-2+a.indexOf("["),b=a.substring(a.indexOf("["),d);var g=new Function('"use strict"; return '+b);e=g(),f.push(e),a=a.substring(a.indexOf("["),a.length),a=a.substring(b.length,a.length)}}catch(h){console.log("Gmail post response parsing failed.",h)}return f},c.tools.parse_requests=function(a,b){a.url_raw=a.url,a.url=c.tools.parse_url(a.url),"object"==typeof a.body?(a.body_params=a.body,a.body_is_object=!0):a.body_params=c.tools.deparam(a.body),"object"!=typeof c.tracker.events&&"object"!=typeof c.tracker.actions&&(c.tracker.events=[],c.tracker.actions=[]),c.tracker.events.unshift(a);var d=c.tools.parse_actions(a,b);return"POST"==a.method&&"string"==typeof a.url.act&&c.tracker.actions.unshift(a),c.tracker.events.length>50&&c.tracker.events.pop(),c.tracker.actions.length>10&&c.tracker.actions.pop(),d},c.tools.xhr_watcher=function(){if(!c.tracker.xhr_init){c.tracker.xhr_init=!0;var a=top.document.getElementById("js_frame")?top.document.getElementById("js_frame").contentDocument.defaultView:window.opener.top.document.getElementById("js_frame").contentDocument.defaultView;a.gjs_XMLHttpRequest_open||(a.gjs_XMLHttpRequest_open=a.XMLHttpRequest.prototype.open),a.XMLHttpRequest.prototype.open=function(b,c,d,e,f){var g=a.gjs_XMLHttpRequest_open.apply(this,arguments);return this.xhrParams={method:b.toString(),url:c.toString()},g},a.gjs_XMLHttpRequest_send||(a.gjs_XMLHttpRequest_send=a.XMLHttpRequest.prototype.send),a.XMLHttpRequest.prototype.send=function(d){var e=!1;if(this.xhrParams&&(this.xhrParams.body=d,e=c.tools.parse_requests(this.xhrParams,this)),c.observe.trigger("before",e,this)&&(d=arguments[0]=this.xhrParams.body_is_object?this.xhrParams.body_params:b.param(this.xhrParams.body_params,!0).replace(/\+/g,"%20")),c.observe.bound(e,"after")){var f=this.onreadystatechange,g=this;this.onreadystatechange=function(a){this.readyState===this.DONE&&(g.xhrResponse=c.tools.parse_response(a.target.responseText),c.observe.trigger("after",e,g)),f&&f.apply(this,arguments)}}var h=a.gjs_XMLHttpRequest_send.apply(this,arguments);return c.observe.trigger("on",e,this),h}}},c.observe.http_requests=function(){return c.tracker.events},c.observe.actions=function(){return c.tracker.actions},c.observe.bind=function(a,b,d){"object"!=typeof c.tracker.watchdog&&(c.tracker.watchdog={before:{},on:{},after:{},dom:{}},c.tracker.bound={}),"object"!=typeof c.tracker.watchdog[a]&&c.tools.error("api.observe.bind called with invalid type: "+a),"dom"==a||c.tracker.xhr_init||c.tools.xhr_watcher(),"object"!=typeof c.tracker.watchdog[a][b]&&(c.tracker.watchdog[a][b]=[]),c.tracker.watchdog[a][b].push(d),c.tracker.bound[b]="undefined"==typeof c.tracker.bound[b]?1:c.tracker.bound[b]+1,c.tracker.bound[a]="undefined"==typeof c.tracker.bound[a]?1:c.tracker.bound[a]+1},c.observe.on=function(a,b,d){return!!c.observe.on_dom(a,b)||(c.observe.bind("on",a,b),void(d&&c.observe.after(a,b)))},c.observe.before=function(a,b){c.observe.bind("before",a,b)},c.observe.after=function(a,b){c.observe.bind("after",a,b)},c.observe.bound=function(a,d){if("object"!=typeof c.tracker.watchdog)return!1;if(a){if("object"==typeof a){var e=!1;return b.each(a,function(a,b){"object"==typeof c.tracker.watchdog[d][a]&&(e=!0)}),e}return d?"object"==typeof c.tracker.watchdog[d][a]:c.tracker.bound[a]>0}return d?c.tracker.bound[d]>0:void c.tools.error("api.observe.bound called with invalid args")},c.observe.off=function(a,d){if("object"!=typeof c.tracker.watchdog)return!0;var e=d?[d]:["before","on","after","dom"];b.each(e,function(d,e){return"object"!=typeof c.tracker.watchdog[e]||void(a?"object"==typeof c.tracker.watchdog[e][a]&&(c.tracker.bound[a]-=c.tracker.watchdog[e][a].length,c.tracker.bound[e]-=c.tracker.watchdog[e][a].length,delete c.tracker.watchdog[e][a]):b.each(c.tracker.watchdog[e],function(a,b){"object"==typeof c.tracker.watchdog[e][a]&&(c.tracker.bound[a]-=c.tracker.watchdog[e][a].length,c.tracker.bound[e]-=c.tracker.watchdog[e][a].length,delete c.tracker.watchdog[e][a])}))})},c.observe.trigger=function(a,d,e){if(!d)return!1;var f=!1;return b.each(d,function(d,g){g=b.extend([],g),"after"==a&&g.push(e.xhrResponse),g.push(e),c.observe.bound(d,a)&&(f=!0,b.each(c.tracker.watchdog[a][d],function(a,b){b.apply(void 0,g)}))}),f},c.observe.trigger_dom=function(a,d,e){e||(e=function(a,b){b(a)}),c.tracker.watchdog.dom[a]&&b.each(c.tracker.watchdog.dom[a],function(a,b){e(d,b)})},c.observe.initialize_dom_observers=function(){c.tracker.dom_observer_init=!0,c.tracker.supported_observers=["view_thread","view_email","load_email_menu","recipient_change","compose"],c.tracker.dom_observers={view_thread:{"class":["Bu","nH"],sub_selector:"div.if",handler:function(a,b){a=new c.dom.thread(a),b(a);var d=a.dom("opened_email");d.length&&c.observe.trigger_dom("view_email",d,c.tracker.dom_observers.view_thread.sub_observers.view_email.handler)},sub_observers:{view_email:{"class":"",sub_selector:"div.adn",handler:function(a,b){a=new c.dom.email(a),b(a)}},load_email_menu:{"class":"J-N",selector:"div[role=menu] div[role=menuitem]:first-child",handler:function(a,b){a=a.closest("div[role=menu]"),b(a)}}}},recipient_change:{"class":"vR",handler:function(a,b){"object"!=typeof c.tracker.recipient_matches&&(c.tracker.recipient_matches=[]),c.tracker.recipient_matches.push(a),setTimeout(function(){if(c.tracker.recipient_matches.length){var a=new c.dom.compose(c.tracker.recipient_matches[0].closest("div.M9")),d=a.recipients();b(a,d,c.tracker.recipient_matches),c.tracker.recipient_matches=[]}},100)}},compose:{"class":"An",handler:function(a,b){if(a=a.closest("div.M9"),a.length){a=new c.dom.compose(a);var d;d=a.is_inline()?0==a.find("input[name=subject]").val().indexOf("Fw")?"forward":"reply":"compose",b(a,d)}}}},c.tracker.custom_supported_observers&&(b.merge(c.tracker.supported_observers,c.tracker.custom_supported_observers),b.extend(!0,c.tracker.dom_observers,c.tracker.custom_dom_observers)),c.tracker.dom_observer_map={},b.each(c.tracker.dom_observers,function(a,d){b.isArray(d["class"])||(d["class"]=[d["class"]]),b.each(d["class"],function(b,d){c.tracker.dom_observer_map[d]=a})})},c.observe.register=function(a,d,e){c.tracker.dom_observer_init&&c.tools.error("Error: Please register all custom DOM observers before binding handlers using gmail.observe.on etc"),c.tracker.custom_supported_observers||(c.tracker.custom_supported_observers=[],c.tracker.custom_dom_observers={});var f={};"object"!=typeof d||b.isArray(d)?f["class"]=d:b.each(["class","selector","sub_selector","handler"],function(a,b){d[b]&&(f[b]=d[b])}),c.tracker.custom_supported_observers.push(a),e?(c.tracker.custom_dom_observers[e]||(c.tracker.custom_dom_observers[e]={sub_observers:{}}),c.tracker.custom_dom_observers[e].sub_observers[a]=f):c.tracker.custom_dom_observers[a]=f},c.observe.on_dom=function(a,d){if(c.tracker.dom_observer_init||c.observe.initialize_dom_observers(),b.inArray(a,c.tracker.supported_observers)>-1){if(!c.tracker.observing_dom){c.tracker.observing_dom=!0,b(window.document).bind("DOMNodeInserted",function(a){c.tools.insertion_observer(a.target,c.tracker.dom_observers,c.tracker.dom_observer_map)});var e=new MutationObserver(function(a){for(var d=0;d<a.length;d++)for(var e=a[d],f=e.removedNodes,g=0;g<f.length;g++){var h=f[g];if("vR"==h.className){var i=c.tracker.dom_observer_map.vR,j=c.tracker.dom_observers.recipient_change.handler;c.observe.trigger_dom(i,b(e.target),j)}}});e.observe(document.body,{subtree:!0,childList:!0})}return c.observe.bind("dom",a,d),!0}if("load"==a){if(c.dom.inbox_content().length)return d();var f=0,g=200,h=50,i=setInterval(function(){var a=c.dom.inbox_content().length;return a>0?(clearInterval(i),d()):void(++f>h&&(clearInterval(i),console.log("Failed to detect interface load in "+g*h/1e3+" seconds. Will automatically fire event in 5 further seconds."),setTimeout(d,5e3)))},g);return!0}},c.tools.insertion_observer=function(a,d,e,f){if(c.tracker.dom_observer_map){var g=a.className||"",h=g.trim().split(/\s+/);h.length||h.push(""),b.each(h,function(f,g){var h=e[g];if(h&&c.tracker.watchdog.dom[h]){var i=b(a),j=d[h];if(j.selector&&!i.is(j.selector))return;if(j.sub_selector&&(i=i.find(j.sub_selector)),i.length){var k=j.handler?j.handler:function(a,b){b(a)};if(c.observe.trigger_dom(h,i,k),j.sub_observers){var l={};b.each(j.sub_observers,function(a,b){l[b["class"]]=a}),i.bind("DOMNodeInserted",function(a){c.tools.insertion_observer(a.target,j.sub_observers,l,"SUB ")})}}}})}},c.tools.make_request=function(a,c){var d=decodeURIComponent(a.replace(/%23/g,"#-#-#"));c=void 0==typeof c||null==typeof c?"GET":c,d=encodeURI(d).replace(/#-#-#/gi,"%23");var e=b.ajax({type:c,url:d,async:!1});return e.responseText},c.tools.make_request_async=function(a,c,d){var e=decodeURIComponent(a.replace(/%23/g,"#-#-#"));c=void 0==typeof c||null==typeof c?"GET":c,e=encodeURI(e).replace(/#-#-#/gi,"%23"),b.ajax({type:c,url:e,async:!0,dataType:"text"}).done(function(a,b,c){d(c.responseText)}).fail(function(a,b,c){console.error("Request Failed",c)})},c.tools.parse_view_data=function(a){for(var b=[],c=[],d=0;d<a.length;d++)if("tb"==a[d][0])for(var e=0;e<a[d][2].length;e++)c.push(a[d][2][e]);for(var f=0;f<c.length;f++){var g=c[f];b.push({id:g[0],title:g[9],excerpt:g[10],time:g[15],sender:g[28],attachment:g[13],labels:g[5]})}return b},c.helper.get.is_delegated_inbox=function(){return"fwd"===c.tracker.globals[17][5][0]},c.helper.get.visible_emails_pre=function(a,d){var e=!1;"undefined"==typeof a&&(a=c.get.current_page()),"undefined"==typeof d&&(e=!0);var f=window.location.origin+window.location.pathname+"?ui=2&ik="+c.tracker.ik+"&rid="+c.tracker.rid+"&view=tl&num=120&rt=1";if(f+=e?b(".Dj:visible").find("b:first").text()?"&start="+ +parseInt(b(".Dj:visible").find("b:first").text()-1)+"&start="+parseInt(b(".Dj:visible").find("b:first").text()-1):"&start=0":"&start="+d,0==a.indexOf("label/"))f+="&cat="+a.split("/")[1]+"&search=cat";else if(0==a.indexOf("category/")){var g="";a.indexOf("forums")!=-1?g="group":a.indexOf("updates")!=-1?g="notification":a.indexOf("promotion")!=-1?g="promo":a.indexOf("social")!=-1&&(g="social"),f+="&cat=^smartlabel_"+g+"&search=category"}else 0==a.indexOf("search/")?(at=b("input[name=at]").val(),f+="&qs=true&q="+a.split("/")[1]+"&at="+at+"&search=query"):"inbox"==a?"true"==b('div[aria-label="Social"]').attr("aria-selected")?(g="social",f+="&cat=^smartlabel_"+g+"&search=category"):"true"==b('div[aria-label="Promotions"]').attr("aria-selected")?(g="promo",f+="&cat=^smartlabel_"+g+"&search=category"):"true"==b('div[aria-label="Updates"]').attr("aria-selected")?(g="notification",f+="&cat=^smartlabel_"+g+"&search=category"):"true"==b('div[aria-label="Forums"]').attr("aria-selected")?(g="group",f+="&cat=^smartlabel_"+g+"&search=category"):f+="&search=inbox":f+="&search="+a;return f},c.helper.get.visible_emails_post=function(a){var d=[];if(!a)return d;a=a.substring(a.indexOf("["),a.length),a='"use strict"; return '+a,a=new Function(a),c.tracker.view_data=a();for(var e in c.tracker.view_data)if("function"!=typeof c.tracker.view_data[e]){var f=c.tools.parse_view_data(c.tracker.view_data[e]);f.length>0&&b.merge(d,f)}return d},c.get.visible_emails=function(){var a=c.helper.get.visible_emails_pre(),b=c.tools.make_request(a),d=c.helper.get.visible_emails_post(b);return d},c.get.visible_emails_async=function(a){var b=c.helper.get.visible_emails_pre();c.tools.make_request_async(b,"GET",function(b){var d=c.helper.get.visible_emails_post(b);a(d)})},c.get.all_emails_async=function(a,b){"undefined"==typeof b&&(b=1);var d=c.helper.get.visible_emails_pre(c.get.current_page(),120*b);c.tools.make_request_async(d,"GET",function(b){var d=c.helper.get.visible_emails_post(b);a(d)})},c.get.selected_emails_data=function(){var a=[];if(c.check.is_inside_email())a.push(c.get.email_data());else if(b('[gh="tl"] div[role="checkbox"][aria-checked="true"]').length){var d=null,e=c.get.visible_emails();b('[gh="tl"] div[role="checkbox"]').each(function(f){"true"==b(this).attr("aria-checked")&&(d=c.get.email_data(e[f].id),a.push(d))})}return a},c.get.current_page=function(){var a=window.location.hash.split("#").pop().split("?").shift()||"inbox",c=["sent","inbox","starred","drafts","imp","chats","all","spam","trash","settings","label","category","circle","search"],d=null;return b.inArray(a,c)>-1&&(d=a),a.indexOf("inbox/")!==-1?d="email":a.match(/\/[0-9a-f]{16,}$/gi)&&(d="email"),d||a},c.tools.infobox=function(a,c,d){var e=b(".b8.UC");if(e.length>0){e.stop(!1,!0);var f=e.find(".vh");if(d?f.html(a):f.text(a),"undefined"!=typeof c){var g=e.attr("style");e.removeAttr("style").fadeTo(c,0,function(){b(this).attr("style",g)})}else e.removeAttr("style")}},c.tools.rerender=function(a){var b,c=window.location.href,d=window.location.hash;b=d.indexOf("/")!==-1?c.replace(/#.*?\//,"#/"):c.replace(/#.*/,"#"),window.location.replace(b),setTimeout(function(){window.location.replace(c),window.history.back(),a&&a()},0)},c.tools.get_reply_to=function(a){var b=void 0!=a?a[4]:[];return 0!==b.length?c.tools.extract_email_address(b[0]):null},c.tools.parse_email_data=function(a){var d={};for(var e in a){var f=a[e];if("cs"==f[0]&&(d.thread_id=f[1],d.first_email=f[8][0],d.last_email=f[2],d.total_emails=f[3],d.total_threads=f[8],d.people_involved=f[15],d.subject=f[23]),"ms"==f[0]){void 0==d.threads&&(d.threads={}),d.threads[f[1]]={},d.threads[f[1]].is_deleted=void 0==f[13],d.threads[f[1]].reply_to_id=f[2],d.threads[f[1]].from=f[5],d.threads[f[1]].from_email=f[6],d.threads[f[1]].timestamp=f[7],d.threads[f[1]].datetime=f[24],d.threads[f[1]].attachments=f[21].split(","),d.threads[f[1]].subject=f[12],d.threads[f[1]].content_html=void 0!=f[13]?f[13][6]:f[8],d.threads[f[1]].to=void 0!=f[13]?f[13][1]:void 0!=f[37]?f[37][1]:[],d.threads[f[1]].cc=void 0!=f[13]?f[13][2]:[],d.threads[f[1]].bcc=void 0!=f[13]?f[13][3]:[],d.threads[f[1]].reply_to=c.tools.get_reply_to(f[13]);try{d.threads[f[1]].content_plain=void 0!=f[13]?b(f[13][6]).text():f[8]}catch(g){d.threads[f[1]].content_plain=void 0!=f[13]?f[13][6]:f[8]}}}return d},c.helper.get.email_data_pre=function(a){c.check.is_inside_email()&&void 0==a&&(a=c.get.email_id());var b=null;return void 0!=a&&(b=window.location.origin+window.location.pathname+"?ui=2&ik="+c.tracker.ik+"&rid="+c.tracker.rid+"&view=cv&th="+a+"&msgs=&mb=0&rt=1&search=mbox"),b},c.helper.get.email_data_post=function(a){if(!a)return{};a=a.substring(a.indexOf("["),a.length),a='"use strict"; return '+a,a=new Function(a);var b=a();return c.tracker.email_data=b[0],c.tools.parse_email_data(c.tracker.email_data)},c.get.email_data=function(a){var b=c.helper.get.email_data_pre(a);if(null!=b){var d=c.tools.make_request(b),e=c.helper.get.email_data_post(d);return e}return{}},c.get.email_data_async=function(a,b){var d=c.helper.get.email_data_pre(a);null!=d?c.tools.make_request_async(d,"GET",function(a){var d=c.helper.get.email_data_post(a);b(d)}):b({})},c.helper.get.email_source_pre=function(a){c.check.is_inside_email()&&void 0==a&&(a=c.get.email_id());var b=null;return void 0!=a&&(b=window.location.origin+window.location.pathname+"?ui=2&ik="+c.tracker.ik+"&view=om&th="+a),b},c.get.email_source=function(a){var b=c.helper.get.email_source_pre(a);return null!=b?c.tools.make_request(b):""},c.get.email_source_async=function(a,b){var d=c.helper.get.email_source_pre(a);null!=d?c.tools.make_request_async(d,"GET",b):b("")},c.get.displayed_email_data=function(){var a=c.get.email_data(),d={};if(c.check.is_conversation_view()){d=a;var e=d.threads,f=d.total_threads,g=window.location.hash.split("#")[1]||"",h=0===g.indexOf("trash");for(var i in e){var j=e[i],k=h?j.is_deleted:!j.is_deleted;k||(delete e[i],f.splice(f.indexOf(i),1),d.total_emails--)}}else for(i in a.threads){var l="m"+i,m=b(".ii.gt .a3s.aXjCH."+l);if(m.length>0){var j=a.threads[i];d.first_email=i,d.last_email=i,d.subject=a.subject,d.threads={},d.threads[i]=j,d.total_emails=1,d.total_threads=[i],d.people_involved=[],d.people_involved.push([j.from,j.from_email]),j.to.forEach(function(a){var b=c.tools.extract_email_address(a),e=c.tools.extract_name(a.replace(b,""))||"";d.people_involved.push([e,b])});break}}return d},c.check.is_conversation_view=function(){for(var a="bx_vmb",b=void 0,d=c.tracker.globals[17][4][1],e=0;e<d.length;e++){var f=d[e];if(f[0]===a){b=f[1];break}}return"0"===b||void 0===b},c.tools.extract_email_address=function(a){var b=/[\+a-z0-9._-]+@[a-z0-9._-]+\.[a-z0-9._-]+/gi,c=a?a.match(b):void 0;return c?c[0]:void 0},c.tools.extract_name=function(a){var b=/[a-z'._-\s]+/gi,c=a?a.match(b):void 0;return c&&c[0]?c[0].trim():void 0},c.tools.i18n=function(a){var b,d=c.get.localization();switch(d){case"fr":b={inbox:"Boîte de réception",drafts:"Brouillons",spam:"Spam",forums:"Forums",updates:"Mises à jour",promotions:"Promotions",social_updates:"Réseaux sociaux"};break;case"nl":b={inbox:"Postvak IN",drafts:"Concepten",spam:"Spam",forums:"Forums",updates:"Updates",promotions:"Reclame",social_updates:"Sociaal"};break;case"en":default:b={inbox:"Inbox",drafts:"Drafts",spam:"Spam",forums:"Forums",updates:"Updates",promotions:"Promotions",social_updates:"Social Updates"}}return b[a]},c.tools.add_toolbar_button=function(a,d,e){var f=b(document.createElement("div"));f.attr("class","G-Ni J-J5-Ji");var g=b(document.createElement("div")),h="T-I J-J5-Ji lS ";h+=void 0!=e&&null!=e&&""!=e?e:"T-I-ax7 ar7",g.attr("class",h),g.html(a),g.click(d);var i=b(document.createElement("div"));return i.attr("class","asa"),f.html(g),c.dom.toolbar().append(f),f},c.tools.add_compose_button=function(a,c,d,e){var f=b(document.createElement("div")),g="T-I J-J5-Ji aoO L3 ";return void 0!=e&&(g+=e),f.attr("class",g),f.html(c),f.click(d),a.find(".gU.Up  > .J-J5-Ji").append(f),f},c.tools.remove_modal_window=function(){b("#gmailJsModalBackground").remove(),b("#gmailJsModalWindow").remove()},c.tools.add_modal_window=function(a,d,e,f,g){g=g||c.tools.remove_modal_window,f=f||c.tools.remove_modal_window;var h=b(document.createElement("div"));h.attr("id","gmailJsModalBackground"),h.attr("class","Kj-JD-Jh"),h.attr("aria-hidden","true"),h.attr("style","opacity:0.75;width:100%;height:100%;");var i=b(document.createElement("div"));i.attr("id","gmailJsModalWindow"),i.attr("class","Kj-JD"),i.attr("tabindex","0"),i.attr("role","alertdialog"),i.attr("aria-labelledby","gmailJsModalWindowTitle"),i.attr("style","left:50%;top:50%;opacity:1;");var j=b(document.createElement("div"));j.attr("class","Kj-JD-K7 Kj-JD-K7-GIHV4");var k=b(document.createElement("span"));k.attr("id","gmailJsModalWindowTitle"),k.attr("class","Kj-JD-K7-K0"),k.attr("role","heading"),k.html(a);var l=b(document.createElement("span"));l.attr("id","gmailJsModalWindowClose"),l.attr("class","Kj-JD-K7-Jq"),l.attr("role","button"),l.attr("tabindex","0"),l.attr("aria-label","Close"),l.click(g),j.append(k),j.append(l);var m=b(document.createElement("div"));m.attr("id","gmailJsModalWindowContent"),m.attr("class","Kj-JD-Jz"),m.html(d);var n=b(document.createElement("div"));n.attr("class","Kj-JD-Jl");var o=b(document.createElement("button"));o.attr("id","gmailJsModalWindowOk"),o.attr("class","J-at1-auR J-at1-atl"),o.attr("name","ok"),o.text("OK"),o.click(e);var p=b(document.createElement("button"));p.attr("id","gmailJsModalWindowCancel"),p.attr("name","cancel"),p.text("Cancel"),p.click(f),n.append(o),n.append(p),i.append(j),i.append(m),i.append(n),b(document.body).append(h),b(document.body).append(i);var q=function(){i.css({top:(b(window).height()-i.outerHeight())/2,left:(b(window).width()-i.outerWidth())/2})};q(),b(window).resize(q)},c.chat.is_hangouts=function(){if(void 0!=c.tracker.hangouts)return c.tracker.hangouts;var a=b(".dw");if(a.length>1)throw"Figuring out is hangouts - more than one dw classes found";if(0==a.length)throw"Figuring out is hangouts - no dw classes found";var d=a[0],e=b(".nH.aJl.nn",d);return e.length>0?(c.tracker.hangouts=!0,
!0):(e=b(".nH.nn",d),e.length>2?(c.tracker.hangouts=!1,!1):void 0)},c.dom.composes=function(){var a=[];return b("div.M9").each(function(b,d){a.push(new c.dom.compose(d))}),a},c.dom.compose=function(a){return a=b(a),a&&(a.hasClass("M9")||a.hasClass("AD"))||c.tools.error("api.dom.compose called with invalid element"),this.$el=a,this},b.extend(c.dom.compose.prototype,{id:function(){return this.dom("id").val()},email_id:function(){return this.dom("draft").val()},is_inline:function(){return this.$el.closest("td.Bu").length>0},recipients:function(a){"object"!=typeof a&&(a={});var b=a.type?"[name="+a.type+"]":"",c=a.flat?[]:{};return this.$el.find(".GS input[type=hidden]"+b).each(function(b,d){a.flat?c.push(d.value):(c[d.name]||(c[d.name]=[]),c[d.name].push(d.value))}),c},to:function(a){return this.dom("to").val(a)},cc:function(a){return this.dom("cc").val(a)},bcc:function(a){return this.dom("bcc").val(a)},subject:function(a){this.dom("subjectbox");return a&&this.dom("all_subjects").val(a),a=this.dom("subjectbox").val(),a?a:this.dom("subject").val()},from:function(){var a=this.dom("from");if(a.length){var b=a.val();if(b)return gmail.tools.extract_email_address(b)}return gmail.get.user_email()},body:function(a){var b=this.dom("body");return a&&b.html(a),b.html()},find:function(a){return this.$el.find(a)},dom:function(a){if(!a)return this.$el;var b={to:"textarea[name=to]",cc:"textarea[name=cc]",bcc:"textarea[name=bcc]",id:"input[name=composeid]",draft:"input[name=draft]",subject:"input[name=subject]",subjectbox:"input[name=subjectbox]",all_subjects:"input[name=subjectbox], input[name=subject]",body:"div[contenteditable=true]",reply:"M9",forward:"M9",from:"input[name=from]"};return b[a]||c.tools.error("Dom lookup failed. Unable to find config for '"+a+"'",b,a,b[a]),this.$el.find(b[a])}}),c.dom.email=function(a){if("string"==typeof a){this.id=a;var d="m"+this.id;this.id_element=b("div.ii.gt div.a3s.aXjCH."+d),a=this.id_element.closest("div.adn")}else a=b(a);if(a&&a.hasClass("adn")||c.tools.error("api.dom.email called with invalid element/id"),!this.id){this.id_element=a.find("div.ii.gt div.a3s.aXjCH");var e=this.id_element.attr("class");if(null!=e){var f=e.match(/(^|\s)m([\S]*)/);null!==f&&(this.id=f.pop())}}return this.$el=a,this},b.extend(c.dom.email.prototype,{body:function(a){var b=this.dom("body");return a&&b.html(a),b.html()},from:function(a,b){var c=this.dom("from");return a&&c.attr("email",a),b&&(c.attr("name",b),c.html(b)),{email:c.attr("email"),name:c.attr("name"),el:c}},to:function(a){if(a){b.isArray(a)||(a=[a]);var c=[];b.each(a,function(a,d){c.push(b("<span />").attr({dir:"ltr",email:d.email,name:d.name}).addClass("g2").html(d.name).wrap("<p/>").parent().html())}),this.dom("to_wrapper").html("to "+c.join(", "))}var d=new Array;return this.dom("to").each(function(a){el=b(this),d.push({email:el.attr("email"),name:el.attr("name"),el:el})}),d},data:function(){if("object"!=typeof c.dom.email_cache&&(c.dom.email_cache={}),!c.dom.email_cache[this.id]){var a=c.get.email_data(this.id);b.each(a.threads,function(a,b){c.dom.email_cache[a]=b})}return c.dom.email_cache[this.id]},source:function(){return c.get.email_source(this.id)},dom:function(a){if(!a)return this.$el;var b={body:"div.a3s",from:"span[email].gD",to:"span[email].g2",to_wrapper:"span.hb",timestamp:"span.g3",star:"div.zd",reply_button:"div[role=button].aaq",menu_button:"div[role=button].aap",details_button:"div[role=button].ajz"};return b[a]||c.tools.error("Dom lookup failed. Unable to find config for '"+a+"'"),this.$el.find(b[a])}}),c.dom.thread=function(a){return a&&a.hasClass("if")||c.tools.error("api.dom.thread called with invalid element/id"),this.$el=a,this},b.extend(c.dom.thread.prototype,{dom:function(a){if(!a)return this.$el;var b={opened_email:"div.adn",subject:"h2.hP",labels:"div.hN"};return b[a]||c.tools.error("Dom lookup failed. Unable to find config for '"+a+"'"),this.$el.find(b[a])}}),c.compose.start_compose=function(){var a=b(".T-I.J-J5-Ji.T-I-KE.L3")[0];if(a){var c=document.createEvent("MouseEvents");c.initEvent("mousedown",!0,!1),a.dispatchEvent(c);var d=document.createEvent("MouseEvents");return d.initEvent("mouseup",!0,!1),a.dispatchEvent(d),!0}return!1},c};window.Gmail||(window.Gmail=initalizeOnce(Gmail_));